# prediction-model-cars
–º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö

–ø–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã:
soft_key_creation
Step0
Step1
Step2
Step3 (–¥–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º)
model_bigger_data (–¥–ª—è –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö - –≤–º–µ—Å—Ç–æ Step3)




–∞—É—Ç–ø—É—Ç —Ç–∞–∫–æ–≤:

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 268315 entries, 0 to 268314
Columns: 158 entries, displacement to price_log
dtypes: float64(158)
memory usage: 323.4 MB
None

–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
0

–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è (price_log) —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
Min: 10.15, Max: 17.83, Mean: 13.96

–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö: 0
–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏: 0

================================================================================
–ü–†–û–í–ï–†–ö–ê –î–£–ë–õ–ò–ö–ê–¢–û–í –í –í–´–ë–û–†–ö–ê–•
================================================================================

–†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º: (268315, 157)
–†–∞–∑–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫ –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:
–û–±—É—á–∞—é—â–∞—è: (214652, 157)
–¢–µ—Å—Ç–æ–≤–∞—è: (53663, 157)
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤...
–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ train –≤—ã–±–æ—Ä–∫–µ: 312
–£–¥–∞–ª–µ–Ω–æ 312 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–∑ train
–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ test –≤—ã–±–æ—Ä–∫–µ: 27
–£–¥–∞–ª–µ–Ω–æ 27 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–∑ test
–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–µ–∂–¥—É train –∏ test: 106
–£–¥–∞–ª–µ–Ω–æ 0 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–∑ test (–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤ train)
–ò—Ç–æ–≥–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã: Train (214340, 157), Test (53636, 157)

================================================================================
–ë–´–°–¢–†–´–ï –ú–û–î–ï–õ–ò –î–õ–Ø –ë–û–õ–¨–®–ò–• –î–ê–ù–ù–´–•
================================================================================

–î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π...

–û–±—É—á–µ–Ω–∏–µ HistGradientBoosting...
‚úì HistGradientBoosting –æ–±—É—á–µ–Ω–∞ –∑–∞ 20.1 —Å–µ–∫
  R¬≤: Train = 0.9345, Test = 0.9197, Gap = 0.0147
  RMSE: 388,135 —Ä—É–±, MAE: 154,760 —Ä—É–±
  MAPE: 10.68%
  –°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π R¬≤ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º: 0.5561

–û–±—É—á–µ–Ω–∏–µ LightGBM...
‚úì LightGBM –æ–±—É—á–µ–Ω–∞ –∑–∞ 7.2 —Å–µ–∫
  R¬≤: Train = 0.9544, Test = 0.9388, Gap = 0.0156
  RMSE: 339,055 —Ä—É–±, MAE: 139,487 —Ä—É–±
  MAPE: 9.81%
  –°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π R¬≤ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º: 0.6194

–û–±—É—á–µ–Ω–∏–µ CatBoost...
‚úì CatBoost –æ–±—É—á–µ–Ω–∞ –∑–∞ 6.0 —Å–µ–∫
  R¬≤: Train = 0.9319, Test = 0.9164, Gap = 0.0155
  RMSE: 396,077 —Ä—É–±, MAE: 158,871 —Ä—É–±
  MAPE: 11.09%
  –°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π R¬≤ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º: 0.5291

–û–±—É—á–µ–Ω–∏–µ RandomForest...
‚úì RandomForest –æ–±—É—á–µ–Ω–∞ –∑–∞ 45.8 —Å–µ–∫
  R¬≤: Train = 0.9389, Test = 0.9235, Gap = 0.0154
  RMSE: 379,049 —Ä—É–±, MAE: 151,761 —Ä—É–±
  MAPE: 11.19%
  –°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π R¬≤ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º: 0.5162

üéØ –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LightGBM —Å RMSE 339,055 —Ä—É–±–ª–µ–π

‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è LightGBM...
Fitting 2 folds for each of 10 candidates, totalling 20 fits
üéØ –õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è LightGBM:
  num_leaves: 63
  n_estimators: 300
  max_depth: 10
  learning_rate: 0.15

–û—Ü–µ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ LightGBM...
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —É–ª—É—á—à–∏–ª–∞ RMSE: 339,055 -> 316,614 —Ä—É–±–ª–µ–π

================================================================================
–î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Ø
================================================================================

üìä HistGradientBoosting:
   –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤: Train=0.9345, Test=0.9197, Gap=0.0147
   RMSE Gap: -32,510 —Ä—É–±
   MAPE Gap: -0.17%
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üìä LightGBM:
   –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤: Train=0.9544, Test=0.9388, Gap=0.0156
   RMSE Gap: -42,322 —Ä—É–±
   MAPE Gap: -0.39%
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üìä CatBoost:
   –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤: Train=0.9319, Test=0.9164, Gap=0.0155
   RMSE Gap: -33,559 —Ä—É–±
   MAPE Gap: -0.11%
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üìä RandomForest:
   –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤: Train=0.9389, Test=0.9235, Gap=0.0154
   RMSE Gap: -35,623 —Ä—É–±
   MAPE Gap: -1.30%
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üìä LightGBM (tuned):
   –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤: Train=0.9711, Test=0.9466, Gap=0.0245
   RMSE Gap: -80,459 —Ä—É–±
   MAPE Gap: -0.82%
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üíæ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ '/Users/mariabug/ML/data/detailed_car_price_predictor.pkl'
üíæ –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: /Users/mariabug/ML/data/best_hyperparameters.json

================================================================================
–î–ï–¢–ê–õ–¨–ù–ê–Ø –°–í–û–î–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
================================================================================

üìä –°–†–ê–í–ù–ï–ù–ò–ï –ú–û–î–ï–õ–ï–ô:
               Model Train R¬≤ Test R¬≤ R¬≤ Gap Test RMSE Test MAE Test MAPE Weighted R¬≤
HistGradientBoosting   0.9345  0.9197 0.0147   388,135  154,760    10.68%      0.5561
            LightGBM   0.9544  0.9388 0.0156   339,055  139,487     9.81%      0.6194
            CatBoost   0.9319  0.9164 0.0155   396,077  158,871    11.09%      0.5291
        RandomForest   0.9389  0.9235 0.0154   379,049  151,761    11.19%      0.5162
    LightGBM (tuned)   0.9711  0.9466 0.0245   316,614  129,317     9.22%      0.6549

üéØ –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –õ–£–ß–®–ï–ô –ú–û–î–ï–õ–ò: LightGBM (tuned)

üìà –û–°–ù–û–í–ù–´–ï –ú–ï–¢–†–ò–ö–ò:
   R¬≤: Train = 0.9711, Test = 0.9466
   RMSE: 316,614 —Ä—É–±
   MAE: 129,317 —Ä—É–±
   MAPE: 9.22%
   –°—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π R¬≤ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º: 0.6549

‚ö†Ô∏è  –ê–ù–ê–õ–ò–ó –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Ø:
   –£—Ä–æ–≤–µ–Ω—å: –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï
   R¬≤ Gap: 0.0245
   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ, –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

üéØ R¬≤ –ü–û –¶–ï–ù–û–í–´–ú –î–ò–ê–ü–ê–ó–û–ù–ê–ú:
----------------------------------------------------------------------
   0 - 500,000               | R¬≤ =  0.4944 | –û–±—Ä–∞–∑—Ü–æ–≤ = 5656 | –î–æ–ª—è =  10.5%
   500,000 - 1,000,000       | R¬≤ =  0.5393 | –û–±—Ä–∞–∑—Ü–æ–≤ = 17227 | –î–æ–ª—è =  32.1%
   1,000,000 - 2,000,000     | R¬≤ =  0.7277 | –û–±—Ä–∞–∑—Ü–æ–≤ = 20332 | –î–æ–ª—è =  37.9%
   2,000,000 - 5,000,000     | R¬≤ =  0.7989 | –û–±—Ä–∞–∑—Ü–æ–≤ = 9194 | –î–æ–ª—è =  17.1%
   5,000,000 - inf           | R¬≤ =  0.7335 | –û–±—Ä–∞–∑—Ü–æ–≤ = 1227 | –î–æ–ª—è =   2.3%

üìä –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –î–ê–ù–ù–´–•:
   –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: (268315, 158)
   –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞: (214340, 157)
   –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞: (53636, 157)

‚ö° –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
